<html>
    <head>
        <script
            type="text/javascript"
            src="../../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * User Model
 * @package \App\Models
 */

namespace App\Models;
use Core\Model;
use PDO;

/**
 * Class ModelUser
 * @package App\Models
 */
class ModelUser extends \Core\Model{

	public static $userID;
	public static $userName;
	public static $userEmail;
	
	/**
	 * function return logged in user id.
	 * if static $usderID is empty in checks $_SESSION['userID']
	 * @return bool | integer
	 */
	public static function getUserID() {
		if(empty(self::$userID) &amp;&amp; isset($_SESSION['userID'])){
			self::$userID = $_SESSION['userID'];
			return self::$userID;
		}else if(!empty(self::$userID)){
			return self::$userID;
		}else{
			return false;
		}
	}
	
	/**
	 * function returns logged in user name.
	 * if static $usderName is empty it checks $_SESSION['userName']
	 * @return bool | string
	 */
	public static function getUserName()
	{
		if(empty(self::$userName) &amp;&amp; isset($_SESSION['userName'])){
			self::$userName = $_SESSION['userName'];
			return self::$userName;
		}else if(!empty(self::$userName)){
			return self::$userName;
		}else{
			return false;
		}
	}
	
	/**
	 * function return loggin in user email.
	 * if static $userEmail is empty it checks $_SESSION['userEmail']
	 * @return bool | string
	 */
	public static function getUserEmail()
	{
		if(empty(self::$userEmail) &amp;&amp; isset($_SESSION['userEmail'])){
			self::$userEmail = $_SESSION['userEmail'];
			return self::$userEmail;
		}else if(!empty(self::$userEmail)){
			return self::$userEmail;
		}else{
			return false;
		}
	}
	
	/**
	 * function checks new user login uniqueness.
	 * @param $data
	 * @return bool|string
	 */
	public static function checkUserName($data)
	{
		$sql1 = &quot;SELECT id
					FROM user
					WHERE user = :user&quot;;
		
		$db = static::getDB();
		$statement = $db-&gt;prepare($sql1);
		$statement-&gt;bindParam(':user', $data['user']);
		$statement-&gt;execute();
		$userID = $statement-&gt;fetch(PDO::FETCH_ASSOC);
		if($userID !== FALSE){
			$errorMessage = &quot;User with name &lt;b&gt;{$data['user']}&lt;/b&gt; already exists!&quot;;
			return $errorMessage;
		}else{
			return FALSE;
		}
	}
	
	/**
	 * function checks new user email uniqueness.
	 * @param $data
	 * @return bool|string
	 */
	public static function checkUserEmail($data)
	{
		$sql = &quot;SELECT id
					FROM user
					WHERE email = :email&quot;;
		
		$statement = \Core\Model::$db-&gt;prepare($sql);
		$statement-&gt;bindParam(':email', $data['email']);
		$statement-&gt;execute();
		$userID = $statement-&gt;fetch(PDO::FETCH_ASSOC);
		if($userID !== FALSE){
			$errorMessage = &quot;User with email &lt;b&gt;{$data['email']}&lt;/b&gt; already exists!&quot;;
			return $errorMessage;
		}else{
			return false;
		}
	}
	
	/**
	 * function register new user in database
	 * @param $data
	 * @return mixed
	 */
	public static function userRegistration($data)
	{
		$sql = &quot;INSERT INTO user 
					(user,email,pass,created)
					VALUES (:user,:email,:pass,NOW())&quot;;
		$statement = \Core\Model::$db-&gt;prepare($sql);
		$userAddStatus = $statement-&gt;execute(array(
			':user'=&gt;$data['user'],
			':email'=&gt;$data['email'],
			':pass'=&gt;$data['pass']
		));
		return $userAddStatus;
	}
	
	/**
	 * function performs new user authorization.
	 * @param $data
	 * @return bool
	 */
	public static function userLogin($data)
	{
		$sql = &quot;SELECT id, user 
				FROM user 
				WHERE email = :email	
				AND pass = :pass&quot;;
		$db = static::getDB();
		$statement = $db-&gt;prepare($sql);
		$statement-&gt;bindParam(':email',$_POST['email']);
		$statement-&gt;bindParam(':pass',$_POST['pass']);
		$statement-&gt;execute();
		$result = $statement-&gt;fetch(PDO::FETCH_ASSOC);
		
		if(!empty($result)){
			$_SESSION['userID'] = $result['id'];
			$_SESSION['userName'] = $result['user'];
			$_SESSION['userEmail'] = $_POST['email'];
			return TRUE;
		}else{
			return FALSE;
		}
	}
}</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all();
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>